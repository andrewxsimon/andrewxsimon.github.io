<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 4: Neural Radiance Field</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .section-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .section-title {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 10px;
        }

        .subsection {
            margin-bottom: 40px;
        }

        .subsection-title {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .text-space {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px dashed #ddd;
            min-height: 100px;
        }

        .text-space h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .text-space p {
            color: #666;
            line-height: 1.6;
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .image-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .image-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .image-display {
            width: 100%;
            height: 300px;
            background: #f5f5f5;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .image-display img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            pointer-events: none;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
        }

        .image-display video,
        .image-display gif {
            pointer-events: none;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
        }

        .comparison-section {
            margin-bottom: 30px;
        }

        .comparison-title {
            font-size: 1.4rem;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
            font-weight: 600;
        }

        .progression-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .image-grid {
                grid-template-columns: 1fr;
            }
            
            .progression-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
            
            .header h1 {
                font-size: 2rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .subsection-title {
                font-size: 1.5rem;
            }
        }
    </style>
    <script>
        // Prevent right-click context menu on images
        document.addEventListener('contextmenu', function(e) {
            if (e.target.tagName === 'IMG') {
                e.preventDefault();
                return false;
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Project 4: Neural Radiance Field</h1>
            <p>Andrew Song</p>
        </div>

        <!-- Part 0: Calibrating Your Camera and Capturing a 3D Scan -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Part 0: Calibrating Your Camera and Capturing a 3D Scan</h2>
            </div>

            <div class="subsection">
                <div class="text-space">
                    <p>Here is the camera frustum visualization of a perfectly scrambled Rubik's cube (I can't solve a Rubik's cube).</p>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/viser0.1.png" alt="Camera Frustum Visualization 1" loading="lazy">
                        </div>
                    </div>

                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/viser0.2.png" alt="Camera Frustum Visualization 2" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Part 1: Fit a Neural Field to a 2D Image -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Part 1: Fit a Neural Field to a 2D Image</h2>
            </div>

            <div class="subsection">
                <div class="text-space">
                    <h4>üìù Model Architecture Report</h4>
                    <p>This model was trained using a mean squared loss function and Adam optimizer. The model was trained for 1200 iterations with a batch size of 10000.
                        The learning rate was set to 0.01 with a max positional frequency of 10 and a hidden layer width of 256. The model was used for the wolf and cat images.
                    </p>
                </div>

                <div class="comparison-section">
                    <div class="comparison-title">Training Progressions</div>
                    <div class="image-grid">
                        <div class="image-item">
                            <div class="image-display">
                                <img src="media/wolf_progression.png" alt="Wolf Training Progression" loading="lazy">
                            </div>
                        </div>

                        <div class="image-item">
                            <div class="image-display">
                                <img src="media/stitches_progression.png" alt="Stitches Training Progression" loading="lazy">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="image-grid">
                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/grid.png" alt="Grid Visualization" loading="lazy">
                        </div>
                    </div>

                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/stitches_psnr.png" alt="Stitches PSNR" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Part 2: Fit a Neural Radiance Field -->
        <div class="section">
            <div class="section-header">
                <h2 class="section-title">Part 2: Fit a Neural Radiance Field</h2>
            </div>

            <!-- Part 2.1: Create Rays from Cameras -->
            <div class="subsection">
                <h3 class="subsection-title">Part 2.1: Create Rays from Cameras</h3>
                <div class="text-space">
                    <p>We find the world coordinates by inverting the world-to-camera transformation matrix and applying the new transformation on the camera coordinates.
                        The homogenous coordinate is added onto the (u,v) pixel before multiplying s, the depth, and the inverse of the intrinsics matrix K.
                        This gets us the camera coordinates.
                        To find the origin vector and the direction vector, we convert the pixel coordinates to camera coordinates and then convert the camera coordinates to world coordinates.
                    </p>
                </div>
            </div>

            <!-- Part 2.2: Sampling -->
            <div class="subsection">
                <h3 class="subsection-title">Part 2.2: Sampling</h3>
                <div class="text-space">
                    <p>We randomly sample coordinates on the images and convert the corresponding pixels to rays. 
                        Then we sample points from those rays by uniformly sampling along the ray.
                    </p>
                </div>
            </div>

            <!-- Part 2.3: Putting the Dataloading All Together -->
            <div class="subsection">
                <h3 class="subsection-title">Part 2.3: Putting the Dataloading All Together</h3>
                <div class="text-space">
                    <p>The dataloader returns the ray origins, ray directions, and sampled colors in the 3D space.</p>
                </div>
                <div class="image-grid" style="grid-template-columns: 1fr;">
                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/viser2.png" alt="Dataloading Visualization" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Part 2.4: Neural Radiance Field -->
            <div class="subsection">
                <h3 class="subsection-title">Part 2.4: Neural Radiance Field</h3>
                <div class="text-space">
                    <p>I construct the neural network with the architecture shown below. </p>
                </div>
                <div class="image-grid" style="grid-template-columns: 1fr;">
                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/nn_arch.png" alt="Neural Network Architecture Diagram" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Part 2.5: Volume Rendering -->
            <div class="subsection">
                <h3 class="subsection-title">Part 2.5: Volume Rendering</h3>
                <div class="text-space">
                    <p>We use the discrete approximation of the volume rendering equation which outputs the final rendered color for each point and ray.
                        The training progression and the final rendering of the Lego truck is shown below.
                    </p>
                </div>

                <div class="comparison-section">
                    <div class="comparison-title">Training Progression</div>
                    <div class="progression-grid">
                        <div class="image-item">
                            <div class="image-display">
                                <img src="media/train_step_200.png" alt="Training Step 200" loading="lazy">
                            </div>
                        </div>

                        <div class="image-item">
                            <div class="image-display">
                                <img src="media/train_step_400.png" alt="Training Step 400" loading="lazy">
                            </div>
                        </div>

                        <div class="image-item">
                            <div class="image-display">
                                <img src="media/train_step_600.png" alt="Training Step 600" loading="lazy">
                            </div>
                        </div>

                        <div class="image-item">
                            <div class="image-display">
                                <img src="media/train_step_800.png" alt="Training Step 800" loading="lazy">
                            </div>
                        </div>

                        <div class="image-item">
                            <div class="image-display">
                                <img src="media/train_step_1000.png" alt="Training Step 1000" loading="lazy">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="image-grid" style="grid-template-columns: 1fr;">
                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/val_psnr_curve.png" alt="Validation PSNR Curve" loading="lazy">
                        </div>
                    </div>
                </div>

                <div class="image-grid" style="grid-template-columns: 1fr;">
                    <div class="image-item">
                        <div class="image-display">
                            <img src="media/lego.gif" alt="Final Lego Rendering" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Part 2.6: Training with Your Own Data -->
            <div class="subsection">
                <h3 class="subsection-title">Part 2.6: Training with Your Own Data</h3>
                <!-- Empty for now -->
            </div>
        </div>
    </div>
</body>
</html>

